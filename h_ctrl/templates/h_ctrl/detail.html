<html>

<head>
    <script src="{{ STATIC_URL }}jquery-1.11.1.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#result").value = "No actions"
            $(".test").click(function () {
                $.post("{% url "ajax" rasp.id %}",
                        {
                            type: "SINGLE",
                            action: $(this).attr("name"),  //The name of action which is passed to the view
                            csrfmiddlewaretoken: '{{ csrf_token }}'
                        },
                        function (data, status) {
                            {#                            alert("Data: " + data + "\nStatus: " + status);#}
                            $("#result").val(data + " = " + status)
                        })
                        .fail(function () {
                            alert("error");
                        });
                return false;
            });
        });
    </script>
    <style>
        .inactive {
            color: red;
        }

        .active {
            color: green;
        }
    </style>
</head>
<body>
<h1>{{ rasp.name }}</h1>

<h1>Все расписания - внезависимости от Pi</h1>
<ul>
    {% for sch in sch_all %}
        <li>
            <div style="white-space: nowrap;">
                {{ sch.name }}
                <table style="border:1px solid  gray; border-collapse: collapse" >
                    <tr>
                        <td style="border-right: 1px solid gray">Статус неопределен</td>
                        <td style="border-right: 1px solid gray"><input type="button" class="sched" id="sch_{{ sch.id }}" name="start" value="Старт"/></td>
                        <td><input type="button" class="sched" id="sch_{{ sch.id }}" name="stop" value="Стоп"/></td>
                    </tr>
                </table>
            </div>

            <ol>
                {% for act in sch.actions.all %}
                    <li><h5>{{ act.name }}</h5></li>
                {% endfor %}
            </ol>
        </li>
    {% endfor %}
</ul>


<br/>

<h1>Actions</h1>
<ul>
    {% for action in rasp.action_set.all %}
        {#        <form id="ActForm" action="" method="POST">#}
        {#            {% csrf_token %}#}
        {#            <li>#}
        {#                <input type="submit" value="{{ action.name }}"/>#}
        {#            </li>#}
        {#        </form>#}
        <li>
            <input type="button" id="action" name="{{ action.name }}" value="{{ action.name }}" class="test"
                   style="width:200px"/>

        </li>
    {% endfor %}
    <li>
        <h4>Result:<input id="result" type="text" readonly="true" value="empty" width="400px"/></h4>
    </li>

</ul>


</body>
</html>